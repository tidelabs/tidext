<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Performs batch Ed25519 signature verification."><meta name="keywords" content="rust, rustlang, rust-lang, batch"><title>ed25519_zebra::batch - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../storage.js"></script><script src="../../crates.js"></script><script defer src="../../main.js"></script>
    <noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../ed25519_zebra/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../../ed25519_zebra/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Module batch</a></h2><div class="sidebar-elems"><section><div class="block"><ul><li><a href="#structs">Structs</a></li></ul></div></section><div id="sidebar-vars" data-name="batch" data-ty="mod" data-relpath="./"></div><script defer src="./sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../ed25519_zebra/index.html"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></a><nav class="sub"><div class="theme-picker hidden"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="22" height="22" alt="Pick another theme!" src="../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Module <a href="../index.html">ed25519_zebra</a>::<wbr><a class="mod" href="#">batch</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../../src/ed25519_zebra/batch.rs.html#1-218">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Performs batch Ed25519 signature verification.</p>
<p>Batch verification asks whether <em>all</em> signatures in some set are valid,
rather than asking whether <em>each</em> of them is valid. This allows sharing
computations among all signature verifications, performing less work overall
at the cost of higher latency (the entire batch must complete), complexity of
caller code (which must assemble a batch of signatures across work-items),
and loss of the ability to easily pinpoint failing signatures.</p>
<p>In addition to these general tradeoffs, design flaws in Ed25519 specifically
mean that batched verification may not agree with individual verification.
Some signatures may verify as part of a batch but not on their own.
This problem is fixed by <a href="https://github.com/zcash/zips/blob/master/zip-0215.rst">ZIP215</a>, a precise specification for edge cases
in Ed25519 signature validation that ensures that batch verification agrees
with individual verification in all cases.</p>
<p>This crate implements ZIP215, so batch verification always agrees with
individual verification, but this is not guaranteed by other implementations.
<strong>Be extremely careful when using Ed25519 in a consensus-critical context
like a blockchain.</strong></p>
<p>This batch verification implementation is adaptive in the sense that it
detects multiple signatures created with the same verification key and
automatically coalesces terms in the final verification equation. In the
limiting case where all signatures in the batch are made with the same
verification key, coalesced batch verification runs twice as fast as ordinary
batch verification.</p>
<p><img src="https://www.zfnd.org/images/coalesced-batch-graph.png" alt="benchmark" /></p>
<p>This optimization doesn’t help much with Zcash, where public keys are random,
but could be useful in proof-of-stake systems where signatures come from a
set of validators (provided that system uses the ZIP215 rules).</p>
<h2 id="example"><a href="#example">Example</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">batch</span> <span class="op">=</span> <span class="ident">batch::Verifier::new</span>();
<span class="kw">for</span> <span class="kw">_</span> <span class="kw">in</span> <span class="number">0</span>..<span class="number">32</span> {
    <span class="kw">let</span> <span class="ident">sk</span> <span class="op">=</span> <span class="ident">SigningKey::new</span>(<span class="ident">rand::thread_rng</span>());
    <span class="kw">let</span> <span class="ident">vk_bytes</span> <span class="op">=</span> <span class="ident">VerificationKeyBytes::from</span>(<span class="kw-2">&amp;</span><span class="ident">sk</span>);
    <span class="kw">let</span> <span class="ident">msg</span> <span class="op">=</span> <span class="string">b&quot;BatchVerifyTest&quot;</span>;
    <span class="kw">let</span> <span class="ident">sig</span> <span class="op">=</span> <span class="ident">sk</span>.<span class="ident">sign</span>(<span class="kw-2">&amp;</span><span class="ident">msg</span>[..]);
    <span class="ident">batch</span>.<span class="ident">queue</span>((<span class="ident">vk_bytes</span>, <span class="ident">sig</span>, <span class="kw-2">&amp;</span><span class="ident">msg</span>[..]));
}
<span class="macro">assert!</span>(<span class="ident">batch</span>.<span class="ident">verify</span>(<span class="ident">rand::thread_rng</span>()).<span class="ident">is_ok</span>());</code></pre></div>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Item.html" title="ed25519_zebra::batch::Item struct">Item</a></div><div class="item-right docblock-short"><p>A batch verification item.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Verifier.html" title="ed25519_zebra::batch::Verifier struct">Verifier</a></div><div class="item-right docblock-short"><p>A batch verification context.</p>
</div></div></div></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-current-crate="ed25519_zebra" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.61.0 (fe5b13d68 2022-05-18)" ></div>
</body></html>